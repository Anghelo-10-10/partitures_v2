ğŸµ Partituras Musicales - API Spring Boot
AplicaciÃ³n backend para la gestiÃ³n de partituras musicales, desarrollada con Spring Boot (Kotlin), Spring Data JPA y PostgreSQL.
Sistema completo para subir, gestionar, buscar y compartir partituras musicales en formato PDF con funcionalidades avanzadas de bÃºsqueda, favoritos y sistema de usuarios.

ğŸ“‹ Requisitos previos

Java 21 (JDK 21)
PostgreSQL 15 o superior
Gradle 8 o superior
Git (opcional)


âš™ï¸ ConfiguraciÃ³n inicial
1. Clonar el repositorio
bashgit clone https://github.com/Anghelo-10-10/partitures_v2.git
cd partitures
2. Iniciar Base de Datos con Docker
bashdocker-compose up -d
3. Ejecutar el Proyecto
bash./gradlew bootRun
La aplicaciÃ³n se ejecuta en http://localhost:8080/
âš ï¸ Nota: La app actualmente es solo API REST (sin interfaz grÃ¡fica). Se puede probar con herramientas como Postman, Insomnia o curl.

ğŸ—„ï¸ ConexiÃ³n a Base de Datos (PgAdmin)
ConfiguraciÃ³n de conexiÃ³n:
CampoValorHostlocalhostPuerto5433UsuarioadminPasswordadminBase de Datospartitures_db

ğŸš€ API Endpoints
ğŸ” AutenticaciÃ³n (/api/auth)
MÃ©todoEndpointDescripciÃ³nBodyPOST/loginIniciar sesiÃ³n{"email": "user@email.com", "password": "password"}
ğŸ‘¤ Usuarios (/api/users)
MÃ©todoEndpointDescripciÃ³nBody/ParamsPOST/Crear usuario{"name": "Usuario", "email": "user@email.com", "password": "Password123"}GET/{id}Obtener usuario por ID-PUT/{id}Actualizar usuario{"name": "Nuevo Nombre", "email": "nuevo@email.com"}DELETE/{id}Eliminar usuario-GET/{id}/profileObtener perfil pÃºblico-PUT/profileActualizar mi perfil?userId=1 + {"name": "Nombre", "bio": "Mi biografÃ­a"}
ğŸ¼ Partituras (/api/sheets)
ğŸ“ CRUD BÃ¡sico
MÃ©todoEndpointDescripciÃ³nContent-TypePOST/Crear partitura con archivo PDFmultipart/form-dataGET/{id}Obtener partitura por ID-PUT/{id}Actualizar metadatos de partituraapplication/jsonPUT/{id}/fileActualizar archivo PDFmultipart/form-dataDELETE/{id}Eliminar partitura-
ğŸ“„ VisualizaciÃ³n y Descarga de PDFs
MÃ©todoEndpointDescripciÃ³nRespuestaGET/{id}/pdfVer PDF en navegadorPDF inlineGET/{id}/pdf/downloadDescargar PDFPDF attachment
ğŸ” BÃºsqueda y Filtros
MÃ©todoEndpointDescripciÃ³nParÃ¡metrosGET/publicPartituras pÃºblicas-GET/searchBÃºsqueda simple?q=terminoGET/search/advancedBÃºsqueda avanzada?searchTerm=&artist=&genre=&instrument=&sortBy=recentGET/genre/{genre}Filtrar por gÃ©nero-GET/instrument/{instrument}Filtrar por instrumento-GET/artist/{artist}Filtrar por artista-GET/recentPartituras recientes-GET/trendingPartituras trending-
ğŸ“Š Filtros Disponibles
MÃ©todoEndpointDescripciÃ³nRespuestaGET/filters/genresGÃ©neros disponibles["Rock", "Jazz", "Classical"]GET/filters/instrumentsInstrumentos disponibles["Piano", "Guitar", "Violin"]GET/filters/artistsArtistas disponibles["Artist 1", "Artist 2"]
ğŸ‘¤ GestiÃ³n por Usuario
MÃ©todoEndpointDescripciÃ³nParÃ¡metrosGET/users/{userId}/ownedPartituras propias del usuario-GET/users/{userId}/favoritesPartituras favoritas del usuario-
â­ Sistema de Favoritos
MÃ©todoEndpointDescripciÃ³nParÃ¡metrosPOST/{sheetId}/favoritesAgregar a favoritos?userId=1DELETE/{sheetId}/favoritesQuitar de favoritos?userId=1GET/{sheetId}/is-favoriteVerificar si es favorito?userId=1
ğŸ“ Archivos (/api/files)
MÃ©todoEndpointDescripciÃ³nRespuestaGET/{fileName}Ver archivoArchivo inlineGET/{fileName}/downloadDescargar archivoArchivo attachmentGET/pdfs/{fileName}Ver PDF especÃ­ficoPDF inlineGET/pdfs/{fileName}/downloadDescargar PDF especÃ­ficoPDF attachment

ğŸ“ Ejemplo de Uso - Crear Partitura
Request
httpPOST /api/sheets
Content-Type: multipart/form-data

file: [archivo.pdf]
title: "Moonlight Sonata"
description: "Sonata No. 14 de Beethoven"
artist: "Ludwig van Beethoven"
genre: "Classical"
instrument: "Piano"
isPublic: true
ownerId: 1
Response
json{
"id": 1,
"title": "Moonlight Sonata",
"description": "Sonata No. 14 de Beethoven",
"artist": "Ludwig van Beethoven",
"genre": "Classical",
"instrument": "Piano",
"pdfFilename": "1698765432_abc12345.pdf",
"pdfSize": 2048576,
"pdfSizeMB": "2.0 MB",
"pdfContentType": "application/pdf",
"pdfDownloadUrl": "/api/sheets/1/pdf",
"isPublic": true,
"ownerId": 1,
"createdAt": "2024-01-15T10:30:00",
"updatedAt": "2024-01-15T10:30:00"
}

âš¡ CaracterÃ­sticas TÃ©cnicas Destacadas
ğŸ” Sistema de BÃºsqueda Avanzado

BÃºsqueda por mÃºltiples campos: tÃ­tulo, artista, descripciÃ³n
Filtros combinables: gÃ©nero, instrumento, artista
Ordenamiento: por fecha, tÃ­tulo, artista
BÃºsqueda insensible a mayÃºsculas/minÃºsculas

ğŸ“ GestiÃ³n de Archivos PDF

ValidaciÃ³n estricta: tamaÃ±o (mÃ¡x 5MB), tipo MIME, magic bytes
Almacenamiento: PDFs guardados como BYTEA en PostgreSQL
OptimizaciÃ³n: Lazy loading para archivos grandes
URLs dinÃ¡micas: visualizaciÃ³n y descarga

ğŸ‘¥ Sistema de Usuarios y Permisos

AutenticaciÃ³n: Email + contraseÃ±a con validaciÃ³n robusta
EncriptaciÃ³n: BCrypt para passwords
Propietarios: Solo el owner puede modificar/eliminar
Perfiles: InformaciÃ³n pÃºblica + biografÃ­a

â­ Sistema de Favoritos Inteligente

RelaciÃ³n Many-to-Many: UserSheet con metadata
Estados duales: isOwner (propietario) + isFavorite (favorito)
GestiÃ³n flexible: Agregar/quitar favoritos independientemente

ğŸš€ Optimizaciones de Performance

Anti N+1 Queries: Batch loading de propietarios
Lazy Loading: Contenido PDF cargado bajo demanda
Ãndices de BD: Optimizados para bÃºsquedas frecuentes
Queries nativas: PostgreSQL ILIKE para bÃºsquedas eficientes

âš ï¸ Manejo de Errores Robusto

Excepciones semÃ¡nticas: Por dominio (users, sheets, files)
CÃ³digos HTTP correctos: 404, 400, 409, 403, 500
Mensajes contextuales: Con informaciÃ³n especÃ­fica del error
GlobalExceptionHandler: Manejo centralizado


ğŸ—‚ï¸ Estructura del Proyecto
src/main/kotlin/com/partituresforall/partitures/
â”œâ”€â”€ ğŸ® controllers/          # API REST endpoints
â”‚   â”œâ”€â”€ AuthController       # AutenticaciÃ³n
â”‚   â”œâ”€â”€ UserController       # GestiÃ³n de usuarios
â”‚   â”œâ”€â”€ SheetController      # GestiÃ³n de partituras
â”‚   â””â”€â”€ FileController       # GestiÃ³n de archivos
â”œâ”€â”€ ğŸ§  services/             # LÃ³gica de negocio
â”‚   â”œâ”€â”€ UserService          # Operaciones de usuario
â”‚   â”œâ”€â”€ SheetService         # Operaciones de partituras
â”‚   â”œâ”€â”€ FileService          # GestiÃ³n de archivos
â”‚   â””â”€â”€ FileValidationService # Validaciones centralizadas
â”œâ”€â”€ ğŸ—„ï¸ repositories/         # Acceso a datos (JPA)
â”‚   â”œâ”€â”€ UserRepository       # Consultas de usuario
â”‚   â”œâ”€â”€ SheetRepository      # Consultas de partituras
â”‚   â””â”€â”€ UserSheetRepository  # RelaciÃ³n usuario-partitura
â”œâ”€â”€ ğŸ—ï¸ models/               # Modelos de datos
â”‚   â”œâ”€â”€ entities/            # Entidades JPA (User, Sheet, UserSheet)
â”‚   â”œâ”€â”€ requests/            # DTOs de entrada
â”‚   â””â”€â”€ responses/           # DTOs de salida
â”œâ”€â”€ âš ï¸ exceptions/           # Manejo de errores
â”‚   â”œâ”€â”€ exceptions/          # Excepciones custom por dominio
â”‚   â””â”€â”€ handlers/            # GlobalExceptionHandler
â””â”€â”€ âš™ï¸ config/               # Configuraciones
â””â”€â”€ PasswordEncoder      # Encoder BCrypt personalizado

ğŸ› ï¸ ConfiguraciÃ³n TÃ©cnica
TecnologÃ­aVersiÃ³nPropÃ³sitoSpring Boot3.5.0Framework principalKotlin1.9+Lenguaje de programaciÃ³nPostgreSQL15Base de datos principalHibernate6.6.15ORM (Object-Relational Mapping)Docker-Contenedor de PostgreSQLBCrypt-EncriptaciÃ³n de contraseÃ±as

ğŸ”§ ConfiguraciÃ³n de Desarrollo
Variables de Entorno (application.yml)
yamlspring:
datasource:
url: jdbc:postgresql://localhost:5433/partitures_db
username: admin
password: admin

servlet:
multipart:
max-file-size: 10MB
max-request-size: 10MB

app:
file:
upload-dir: uploads
Docker Compose
yamlservices:
postgres:
image: postgres:15
environment:
POSTGRES_DB: partitures_db
POSTGRES_USER: admin
POSTGRES_PASSWORD: admin
ports:
- "5433:5432"

ğŸš€ PrÃ³ximas Mejoras Planeadas

AutenticaciÃ³n JWT + Spring Security
Validaciones @Valid en controllers
PaginaciÃ³n para endpoints de listas
Tests unitarios e integraciÃ³n
DocumentaciÃ³n Swagger/OpenAPI
Cache Redis para consultas frecuentes
MÃ©tricas y observabilidad
Interfaz web frontend


ğŸ§ª Testing Manual
Puedes probar la API usando Postman, Insomnia o curl:
bash# Crear usuario
curl -X POST http://localhost:8080/api/users \
-H "Content-Type: application/json" \
-d '{"name":"Test User","email":"test@example.com","password":"Password123"}'

# Login
curl -X POST http://localhost:8080/api/auth/login \
-H "Content-Type: application/json" \
-d '{"email":"test@example.com","password":"Password123"}'

# Obtener partituras pÃºblicas
curl http://localhost:8080/api/sheets/public

ğŸ“ Contacto y ContribuciÃ³n

Repositorio: GitHub - partitures_v2
Autor: Anghelo-10-10
Stack: Kotlin + Spring Boot + PostgreSQL


Â¡La API estÃ¡ lista para ser consumida por cualquier frontend o aplicaciÃ³n mÃ³vil! ğŸµâœ¨